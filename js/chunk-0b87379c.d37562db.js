(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-0b87379c"],{2957:function(t,e,a){"use strict";var r=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-card",{staticClass:"pa-3",staticStyle:{"border-bottom":"thin solid rgba(0, 0, 0, 0.12)"},attrs:{flat:"",tile:""}},[a("v-row",{staticClass:"pa-0",staticStyle:{"flex-wrap":"nowrap"},attrs:{"no-gutters":""}},[a("v-col",{staticClass:"flex-grow-1"},[a("router-link",{attrs:{to:{name:"user",params:{id:t.user.id}}}},[a("v-avatar",{staticClass:"mt-1"},[a("v-img",{attrs:{src:t._f("emptyImage")(t.user.avatar),alt:t.user.name}})],1)],1)],1),a("v-col",{staticClass:"flex-shrink-1",attrs:{cols:"11"}},[a("v-row",{staticClass:"pa-0",attrs:{"no-gutters":"",align:"center"}},[a("v-col",{staticClass:"d-flex flex-column pa-2 ma-0",attrs:{"no-gutters":"",cols:"9"}},[a("p",{staticClass:"subtitle-2 font-weight-bold ma-0 pa-0"},[t._v(t._s(t.user.name))]),a("p",{staticClass:"subtitle-2 grey--text font-weight-normal ma-0 pa-0",staticStyle:{"text-decoration":"none"}},[t._v(" @"+t._s(t.user.account)+" ")])]),a("v-spacer"),a("v-col",{staticClass:"d-flex ma-0 pa-2",attrs:{"no-gutters":"",cols:"auto"}},[t.isFollowed?a("v-btn",{attrs:{loading:t.isLoading,rounded:"",small:"",elevation:"0",color:"primary"},on:{click:function(e){return e.stopPropagation(),e.preventDefault(),t.deleteFollowing(t.user.id)}}},[t._v(" 正在跟隨 ")]):a("v-btn",{attrs:{loading:t.isLoading,rounded:"",outlined:"",small:"",color:"primary"},on:{click:function(e){return e.stopPropagation(),e.preventDefault(),t.addFollowing(t.user.id)}}},[t._v(" 跟隨 ")])],1)],1),a("v-row",{staticClass:"d-flex flex-wrap font-weight-normal px-2",attrs:{"no-gutters":"",align:"center"}},[a("v-col",{staticClass:"body-2 font-weight-normal text-justify my-0"},[t._v(" "+t._s(t.user.introduction)+" ")])],1)],1)],1)],1)},o=[],n=a("1da1"),s=a("5530"),i=(a("96cf"),a("2708")),l=a("4cce"),c=a("2fa3"),u=a("2f62"),d={name:"userCard",props:{currentUser:{type:Object,required:!0},initialUser:{type:Object,required:!0},initialIsFollowed:{type:Boolean,required:!0}},mixins:[i["a"]],data:function(){return{user:Object(s["a"])({},this.initialUser),isFollowed:this.initialIsFollowed,isLoading:!1}},watch:{initialUser:{handler:function(t){this.user=Object(s["a"])(Object(s["a"])({},this.user),t)},deep:!0,immediate:!0},initialIsFollowed:function(t){this.isFollowed=t}},methods:Object(s["a"])(Object(s["a"])({},Object(u["c"])({setfollowshipUpdate:"setfollowshipUpdate"})),{},{addFollowing:function(t){var e=this;return Object(n["a"])(regeneratorRuntime.mark((function a(){var r,o,n;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:if(a.prev=0,e.isLoading=!0,e.setfollowshipUpdate(null,{root:!0}),t!==e.currentUser.id){a.next=8;break}return c["a"].fire({icon:"error",title:"無法跟隨自己"}),e.isLoading=!1,e.setfollowshipUpdate(null,{root:!0}),a.abrupt("return");case 8:return r={id:t},a.next=11,l["a"].addFollowing({followingId:r});case 11:if(o=a.sent,n=o.data,"success"===n.status){a.next=15;break}throw new Error(n.message);case 15:e.isFollowed=!0,e.isLoading=!1,e.setfollowshipUpdate(null,{root:!0}),c["a"].fire({icon:"success",title:"成功加入跟隨"}),a.next=26;break;case 21:a.prev=21,a.t0=a["catch"](0),e.isLoading=!1,e.setfollowshipUpdate(null,{root:!0}),c["a"].fire({icon:"error",title:"無法加入跟隨，請稍後再試"});case 26:case"end":return a.stop()}}),a,null,[[0,21]])})))()},deleteFollowing:function(t){var e=this;return Object(n["a"])(regeneratorRuntime.mark((function a(){var r,o;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return a.prev=0,e.isLoading=!0,e.setfollowshipUpdate(null,{root:!0}),a.next=5,l["a"].deleteFollowing({followingId:t});case 5:if(r=a.sent,o=r.data,"error"!==o.status){a.next=9;break}throw new Error(o.message);case 9:e.$emit("after-delete-following",t),e.isFollowed=!1,e.isLoading=!1,e.setfollowshipUpdate(null,{root:!0}),c["a"].fire({icon:"success",title:"成功取消跟隨"}),a.next=22;break;case 16:a.prev=16,a.t0=a["catch"](0),e.isLoading=!1,e.setfollowshipUpdate(null,{root:!0}),console.error(a.t0.message),c["a"].fire({icon:"error",title:"無法取消跟隨，請稍後再試"});case 22:case"end":return a.stop()}}),a,null,[[0,16]])})))()}})},f=d,p=a("2877"),w=a("6544"),g=a.n(w),h=a("8212"),m=a("8336"),b=a("b0af"),v=a("62ad"),x=a("adda"),F=a("0fd9"),U=a("2fa4"),k=Object(p["a"])(f,r,o,!1,null,null,null);e["a"]=k.exports;g()(k,{VAvatar:h["a"],VBtn:m["a"],VCard:b["a"],VCol:v["a"],VImg:x["a"],VRow:F["a"],VSpacer:U["a"]})},cc95:function(t,e,a){"use strict";a.r(e);var r=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-container",{staticClass:"ma-0 pa-0"},[a("v-tabs",{staticStyle:{"border-bottom":"thin solid rgba(0, 0, 0, 0.12)"},attrs:{"background-color":"transparent",color:"primary"},model:{value:t.tabs.active_tab,callback:function(e){t.$set(t.tabs,"active_tab",e)},expression:"tabs.active_tab"}},t._l(t.tabs.tabs,(function(e){return a("v-tab",{key:e.id,staticClass:"font-weight-bold",attrs:{to:e.link}},[t._v(" "+t._s(e.name)+" ")])})),1),t._l(t.followings,(function(e){return a("UserCard",{key:e.id,attrs:{initialUser:e.Following,initialIsFollowed:e.isFollowed,currentUser:t.currentUser},on:{"after-delete-following":t.afterDeleteFollowing}})}))],2)},o=[],n=a("1da1"),s=a("5530"),i=(a("4de4"),a("96cf"),a("2957")),l=a("2f62"),c=a("4cce"),u=a("2fa3"),d={name:"UserFollowing",components:{UserCard:i["a"]},data:function(){return{tabs:{active_tab:1,tabs:[{index:0,name:"跟隨者",link:"follower"},{index:1,name:"正在跟隨",link:"following"}]},followings:[]}},computed:Object(s["a"])({},Object(l["d"])(["currentUser","topFollowshipUpdate"])),watch:{topFollowshipUpdate:{handler:function(){var t=this.$route.params.id;this.fetchFollowings(t)},deep:!0,immediate:!0}},created:function(){var t=this.$route.params.id;this.fetchFollowings(t)},beforeRouteUpdate:function(t,e,a){var r=t.params.id;this.fetchFollowings(r),a()},methods:{fetchFollowings:function(t){var e=this;return Object(n["a"])(regeneratorRuntime.mark((function a(){var r,o;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return a.prev=0,a.next=3,c["a"].getUserFollowings({userId:t});case 3:if(r=a.sent,o=r.data,"error"!==o.status){a.next=7;break}throw new Error(o.message);case 7:e.followings=o,a.next=13;break;case 10:a.prev=10,a.t0=a["catch"](0),u["a"].fire({icon:"error",title:"無法取得使用者資料，請稍後再試"});case 13:case"end":return a.stop()}}),a,null,[[0,10]])})))()},afterDeleteFollowing:function(t){var e=t;this.followings=this.followings.filter((function(t){return t.followingId!==e}))}}},f=d,p=a("2877"),w=a("6544"),g=a.n(w),h=a("a523"),m=a("71a3"),b=a("fe57"),v=Object(p["a"])(f,r,o,!1,null,null,null);e["default"]=v.exports;g()(v,{VContainer:h["a"],VTab:m["a"],VTabs:b["a"]})}}]);
//# sourceMappingURL=chunk-0b87379c.d37562db.js.map